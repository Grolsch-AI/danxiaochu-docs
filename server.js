const express = require('express');
const path = require('path');

const app = express();
const PORT = process.env.PORT || 3000;

// å®Œæ•´æ–‡æ¡£æ•°æ®
let appData = {
  documents: [
    {
      _id: 'doc_1',
      title: 'è›‹å°å¨ PRD v1.0',
      type: 'prd',
      content: `# è›‹å°å¨ äº§å“éœ€æ±‚æ–‡æ¡£ v1.0

## ä¸€ã€äº§å“æ¦‚è¿°

### 1.1 äº§å“åç§°
**è›‹å°å¨** (åŸåï¼šèšé¤ç¥å™¨)

### 1.2 äº§å“å®šä½
ä¸€æ¬¾åŸºäºå¾®ä¿¡å°ç¨‹åºçš„ç¾¤ä½“ç”¨é¤å†³ç­–å·¥å…·ï¼Œé€šè¿‡æŠ•ç¥¨æœºåˆ¶å¸®åŠ©ç”¨æˆ·ç¾¤ä½“å¿«é€Ÿè¾¾æˆç”¨é¤å…±è¯†ã€‚

### 1.3 äº§å“æ„¿æ™¯
**ä¸“æ³¨è§£å†³æ¯å¤©åƒå•¥çš„ä¸–çºªéš¾é¢˜**

### 1.4 ç›®æ ‡ç”¨æˆ·
- å…¬å¸åŒäº‹èšé¤ç‚¹é¤åœºæ™¯
- æœ‹å‹èšä¼šé€‰æ‹©é¤å…/èœå“
- å®¶åº­æˆå‘˜å†³å®šæ—¥å¸¸é¥®é£Ÿ
- ä»»ä½•éœ€è¦ç¾¤ä½“å†³ç­–ã€Œåƒä»€ä¹ˆã€çš„åœºæ™¯

### 1.5 æ ¸å¿ƒä»·å€¼
| ç”¨æˆ·ç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ |
|---------|---------|
| æ¯æ¬¡èšé¤è®¨è®ºåƒä»€ä¹ˆè¦èŠ±å¾ˆé•¿æ—¶é—´ | æŠ•ç¥¨æœºåˆ¶å¿«é€Ÿå†³ç­– |
| ç¾¤é‡Œé—®ä¸€åœˆéƒ½è¯´"éšä¾¿" | å¼ºåˆ¶é€‰æ‹©ï¼Œæ˜ç¡®è¡¨æ€ |
| ä¼—å£éš¾è°ƒï¼Œæ€»æœ‰äººä¸æ»¡æ„ | æ°‘ä¸»æŠ•ç¥¨ï¼Œå°‘æ•°æœä»å¤šæ•° |
| ç»Ÿè®¡å¤§å®¶æƒ³åƒä»€ä¹ˆå¾ˆéº»çƒ¦ | è‡ªåŠ¨ç»Ÿè®¡ï¼Œå®æ—¶ç»“æœ |

---

## äºŒã€åŠŸèƒ½æ¶æ„

### 2.1 åŠŸèƒ½ç»“æ„å›¾
\`\`\`
è›‹å°å¨
â”œâ”€â”€ é¦–é¡µ
â”‚   â”œâ”€â”€ ç”¨æˆ·ä¿¡æ¯å±•ç¤º
â”‚   â”œâ”€â”€ åˆ›å»ºæˆ¿é—´å…¥å£
â”‚   â”œâ”€â”€ åŠ å…¥æˆ¿é—´å…¥å£
â”‚   â””â”€â”€ æˆ‘çš„æˆ¿é—´åˆ—è¡¨
â”œâ”€â”€ åˆ›å»ºæˆ¿é—´
â”‚   â”œâ”€â”€ æˆ¿é—´åç§°è®¾ç½®
â”‚   â”œâ”€â”€ èœå•ç¼–è¾‘ï¼ˆå¢åˆ æ”¹ï¼‰
â”‚   â”œâ”€â”€ èœå“å›¾ç‰‡ä¸Šä¼ 
â”‚   â””â”€â”€ é¢„è®¾æ¨¡æ¿é€‰æ‹©
â”œâ”€â”€ æˆ¿é—´è¯¦æƒ…
â”‚   â”œâ”€â”€ æŠ•ç¥¨è§†å›¾
â”‚   â”‚   â”œâ”€â”€ èœå“åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ å¤šé€‰æŠ•ç¥¨
â”‚   â”‚   â””â”€â”€ å·²é€‰ç»Ÿè®¡
â”‚   â”œâ”€â”€ ç»“æœè§†å›¾
â”‚   â”‚   â”œâ”€â”€ æ’åå±•ç¤º
â”‚   â”‚   â”œâ”€â”€ ç¥¨æ•°ç»Ÿè®¡
â”‚   â”‚   â””â”€â”€ æŠ•ç¥¨äººæ˜¾ç¤º
â”‚   â””â”€â”€ æˆ¿é—´ç®¡ç†
â”‚       â”œâ”€â”€ åˆ†äº«é‚€è¯·
â”‚       â”œâ”€â”€ ç»“æŸæŠ•ç¥¨
â”‚       â””â”€â”€ åˆ é™¤æˆ¿é—´
â””â”€â”€ ä¸ªäººä¸­å¿ƒï¼ˆè§„åˆ’ä¸­ï¼‰
    â”œâ”€â”€ å†å²è®°å½•
    â”œâ”€â”€ æˆ‘çš„æ¨¡æ¿
    â””â”€â”€ è®¾ç½®
\`\`\`

### 2.2 æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

#### 2.2.1 åˆ›å»ºæˆ¿é—´
- **æˆ¿é—´åç§°**ï¼šæœ€å¤š20å­—ï¼Œå¦‚"å‘¨äº”éƒ¨é—¨èšé¤"
- **èœå•è®¾ç½®**ï¼š
  - æ”¯æŒæ·»åŠ 1-20é“èœå“
  - æ¯é“èœå“åŒ…å«ï¼šåç§°ã€ä»·æ ¼ã€å¤‡æ³¨ã€å›¾ç‰‡
  - å›¾ç‰‡è‡ªåŠ¨å‹ç¼©ï¼ˆå¤§å›¾+ç¼©ç•¥å›¾ï¼‰
- **é¢„è®¾æ¨¡æ¿**ï¼šå·èœã€ç²¤èœã€å®¶å¸¸èœã€è¥¿é¤ç­‰å¿«æ·æ¨¡æ¿
- **æˆ¿é—´æœ‰æ•ˆæœŸ**ï¼š24å°æ—¶è‡ªåŠ¨è¿‡æœŸ

#### 2.2.2 æŠ•ç¥¨æœºåˆ¶
- **å¤šé€‰æŠ•ç¥¨**ï¼šç”¨æˆ·å¯é€‰æ‹©å¤šé“æƒ³åƒçš„èœ
- **å®æ—¶åŒæ­¥**ï¼šæŠ•ç¥¨ç»“æœå®æ—¶æ›´æ–°
- **ä¿®æ”¹æŠ•ç¥¨**ï¼šæŠ•ç¥¨åå¯ä¿®æ”¹é€‰æ‹©
- **åŒ¿å/å®å**ï¼šç»“æœé¡µæ˜¾ç¤ºæŠ•ç¥¨äººæ˜µç§°

#### 2.2.3 åˆ†äº«é‚€è¯·
- **é‚€è¯·ç **ï¼š6ä½å­—æ¯æ•°å­—ç»„åˆ
- **åˆ†äº«å¡ç‰‡**ï¼šå¾®ä¿¡å°ç¨‹åºåˆ†äº«å¡ç‰‡
- **æ‰«ç åŠ å…¥**ï¼šæ”¯æŒäºŒç»´ç æ‰«ç ï¼ˆè§„åˆ’ä¸­ï¼‰

---

## ä¸‰ã€é¡µé¢è®¾è®¡

### 3.1 é¦–é¡µ
| å…ƒç´  | è¯´æ˜ |
|------|------|
| LogoåŒºåŸŸ | è›‹å°å¨å“ç‰Œæ ‡è¯† + Slogan |
| ç”¨æˆ·å¡ç‰‡ | å¤´åƒã€æ˜µç§°ã€ç‚¹å‡»å¯ç¼–è¾‘ |
| æ“ä½œæŒ‰é’® | åˆ›å»ºæˆ¿é—´ã€åŠ å…¥æˆ¿é—´ |
| æˆ¿é—´åˆ—è¡¨ | æˆ‘å‚ä¸çš„æˆ¿é—´ï¼ŒæŒ‰æ—¶é—´æ’åº |

### 3.2 åˆ›å»ºæˆ¿é—´é¡µ
| å…ƒç´  | è¯´æ˜ |
|------|------|
| æˆ¿é—´åç§° | è¾“å…¥æ¡†ï¼Œ20å­—é™åˆ¶ |
| èœå“å¡ç‰‡ | å·¦å›¾å³è¡¨å•å¸ƒå±€ |
| æ·»åŠ æŒ‰é’® | æ·»åŠ æ–°èœå“ |
| æ¨¡æ¿åŒºåŸŸ | å¿«æ·æ¨¡æ¿é€‰æ‹© |
| åˆ›å»ºæŒ‰é’® | åº•éƒ¨å›ºå®š |

### 3.3 æˆ¿é—´è¯¦æƒ…é¡µ
| å…ƒç´  | è¯´æ˜ |
|------|------|
| æˆ¿é—´å¤´éƒ¨ | åç§°ã€é‚€è¯·ç ã€äººæ•°ã€å€’è®¡æ—¶ |
| Tabåˆ‡æ¢ | æŠ•ç¥¨/ç»“æœ |
| èœå“ç½‘æ ¼ | 2åˆ—å±•ç¤ºï¼Œç‚¹å‡»é€‰ä¸­ |
| åº•éƒ¨æ“ä½œ | æäº¤æŠ•ç¥¨/åˆ†äº«æˆ¿é—´ |

---

## å››ã€æŠ€æœ¯æ¶æ„

### 4.1 æŠ€æœ¯é€‰å‹
| å±‚çº§ | æŠ€æœ¯æ–¹æ¡ˆ |
|------|---------|
| å‰ç«¯ | å¾®ä¿¡å°ç¨‹åºåŸç”Ÿå¼€å‘ |
| åç«¯ | å¾®ä¿¡äº‘å¼€å‘ï¼ˆäº‘å‡½æ•°ï¼‰ |
| æ•°æ®åº“ | å¾®ä¿¡äº‘æ•°æ®åº“ |
| å­˜å‚¨ | å¾®ä¿¡äº‘å­˜å‚¨ |

### 4.2 æ•°æ®åº“è®¾è®¡

#### rooms é›†åˆ
\`\`\`javascript
{
  _id: "æˆ¿é—´ID",
  code: "ABC123",           // 6ä½é‚€è¯·ç 
  name: "å‘¨äº”èšé¤",          // æˆ¿é—´åç§°
  creatorOpenId: "xxx",     // åˆ›å»ºè€…OpenID
  status: "active",         // active/closed
  menu: [                   // èœå•åˆ—è¡¨
    {
      id: "dish_1",
      name: "å®«ä¿é¸¡ä¸",
      price: 38,
      remark: "å¾®è¾£",
      imageSmall: "ç¼©ç•¥å›¾URL",
      imageLarge: "å¤§å›¾URL"
    }
  ],
  members: ["openId1", "openId2"],  // æˆå‘˜åˆ—è¡¨
  createTime: 1703145600000,
  expireTime: 1703232000000
}
\`\`\`

#### votes é›†åˆ
\`\`\`javascript
{
  _id: "æŠ•ç¥¨ID",
  roomId: "æˆ¿é—´ID",
  odpenId: "ç”¨æˆ·OpenID",
  odpenName: "ç”¨æˆ·æ˜µç§°",
  selectedDishes: ["dish_1", "dish_3"],  // é€‰ä¸­çš„èœå“ID
  createTime: 1703145600000,
  updateTime: 1703145600000
}
\`\`\`

### 4.3 äº‘å‡½æ•°åˆ—è¡¨
| å‡½æ•°å | åŠŸèƒ½ |
|--------|------|
| createRoom | åˆ›å»ºæˆ¿é—´ |
| joinRoom | åŠ å…¥æˆ¿é—´ |
| getRoomDetail | è·å–æˆ¿é—´è¯¦æƒ… |
| submitVote | æäº¤æŠ•ç¥¨ |
| getVoteResults | è·å–æŠ•ç¥¨ç»“æœ |
| closeRoom | å…³é—­æˆ¿é—´ |
| uploadImage | ä¸Šä¼ å›¾ç‰‡ |

---

## äº”ã€è¿è¥è§„åˆ’

### 5.1 ç›®æ ‡ç”¨æˆ·è·å–
- å¾®ä¿¡æœ‹å‹åœˆåˆ†äº«
- å¾®ä¿¡ç¾¤å£ç¢‘ä¼ æ’­
- å°çº¢ä¹¦ç§è‰ç¬”è®°
- æŠ–éŸ³çŸ­è§†é¢‘æ¨å¹¿

### 5.2 æ ¸å¿ƒæŒ‡æ ‡
| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| DAU | 1000+ |
| æ–°å¢ç”¨æˆ· | 100+/å¤© |
| æˆ¿é—´åˆ›å»ºæ•° | 50+/å¤© |
| æ¬¡æ—¥ç•™å­˜ç‡ | 30%+ |

---

## å…­ã€ç‰ˆæœ¬è§„åˆ’

### v1.0ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
- [x] åŸºç¡€æŠ•ç¥¨åŠŸèƒ½
- [x] æˆ¿é—´åˆ›å»ºä¸åŠ å…¥
- [x] èœå“å›¾ç‰‡ä¸Šä¼ 
- [x] å®æ—¶æŠ•ç¥¨ç»“æœ

### v1.1ï¼ˆè§„åˆ’ä¸­ï¼‰
- [ ] æˆ¿é—´æœ‰æ•ˆæœŸå»¶é•¿æœºåˆ¶
- [ ] èœå“åˆ†ç±»åŠŸèƒ½
- [ ] æŠ•ç¥¨æ’¤é”€åŠŸèƒ½
- [ ] æ–°æ‰‹å¼•å¯¼

### v2.0ï¼ˆè¿œæœŸè§„åˆ’ï¼‰
- [ ] è®¢é˜…æ¶ˆæ¯é€šçŸ¥
- [ ] å†å²è®°å½•ä¸ç»Ÿè®¡
- [ ] ä¸ªäººå£å‘³åå¥½
- [ ] é¤å…æ¨èé›†æˆ`,
      createdAt: 1703145600000,
      updatedAt: 1703318400000
    },
    {
      _id: 'doc_2',
      title: 'æµ‹è¯•å¤ç›˜æŠ¥å‘Š v1.0',
      type: 'test',
      content: `# è›‹å°å¨ v1.0 ç³»ç»Ÿæ€§æµ‹è¯•å¤ç›˜æŠ¥å‘Š

## ä¸€ã€æµ‹è¯•æ¦‚è¿°

### 1.1 æµ‹è¯•èŒƒå›´
- æµ‹è¯•è½®æ¬¡ï¼š10è½®
- æµ‹è¯•æ—¶é—´ï¼š2024å¹´12æœˆ
- æµ‹è¯•ç¯å¢ƒï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…· + çœŸæœºæµ‹è¯•
- æµ‹è¯•ç‰ˆæœ¬ï¼šv1.0

### 1.2 é—®é¢˜æ±‡æ€»
| ä¼˜å…ˆçº§ | æ•°é‡ | ç±»å‹ |
|--------|------|------|
| **P0** | 2ä¸ª | é˜»æ–­ç”¨æˆ·æ ¸å¿ƒæµç¨‹ |
| **P1** | 5ä¸ª | ä¸¥é‡å½±å“ä½“éªŒ |
| **P2** | 5ä¸ª | å½±å“éƒ¨åˆ†ä½“éªŒ |
| **P3** | 3ä¸ª | é”¦ä¸Šæ·»èŠ± |

---

## äºŒã€P0 ä¸¥é‡é—®é¢˜ï¼ˆé˜»æ–­æ€§ï¼‰

### é—®é¢˜1ï¼šæˆ¿é—´24å°æ—¶è¿‡æœŸæœºåˆ¶ä¸åˆç†

**é—®é¢˜åˆ†ç±»**ï¼šåŠŸèƒ½è®¾è®¡ç¼ºé™·

**é—®é¢˜æè¿°**ï¼š
- æˆ¿é—´åˆ›å»ºåä»…æœ‰24å°æ—¶æœ‰æ•ˆæœŸï¼Œè¿‡æœŸåæ— æ³•æŠ•ç¥¨
- åˆ›å»ºè€…è¾›è‹¦ç¼–è¾‘çš„èœå•24å°æ—¶åå¤±æ•ˆï¼Œæ— æ³•å¤ç”¨
- åˆ†äº«é“¾æ¥24å°æ—¶åå¤±æ•ˆï¼Œæ–°æˆå‘˜æ— æ³•åŠ å…¥
- å¯¹äºéœ€è¦æå‰è§„åˆ’çš„èšé¤åœºæ™¯ï¼ˆå¦‚å‘¨æœ«èšé¤å‘¨ä¸€å°±å¼€å§‹è®¨è®ºï¼‰ï¼Œ24å°æ—¶è¿œè¿œä¸å¤Ÿ

**å½±å“åˆ†æ**ï¼š
- åˆ›å»ºè€…ç»´æŠ¤èœå•çš„æ„æ„¿å¤§å¹…é™ä½
- è¿‡æœŸæˆ¿é—´çš„æˆå‘˜ç‚¹å‡»é“¾æ¥åä½“éªŒæ–­è£‚
- æ— æ³•æ”¯æŒé•¿æœŸ/å‘¨æœŸæ€§èšé¤åœºæ™¯

**ä¿®æ”¹å»ºè®®**ï¼š

**æ–¹æ¡ˆAï¼šä»˜è´¹å»¶é•¿ï¼ˆæ¨èï¼‰**
- é»˜è®¤æœ‰æ•ˆæœŸä¿æŒ24å°æ—¶ï¼ˆå…è´¹ï¼‰
- è§‚çœ‹æ¿€åŠ±è§†é¢‘å¯å»¶é•¿24å°æ—¶ï¼ˆæ¯æ—¥é™3æ¬¡ï¼‰
- é‚€è¯·1ä½æ–°ç”¨æˆ·æ³¨å†Œå¯å»¶é•¿48å°æ—¶
- åˆ›å»ºè€…å¯é€‰æ‹©ã€Œæ°¸ä¹…æˆ¿é—´ã€ï¼ˆéœ€é‚€è¯·3äººæˆ–è§‚çœ‹5ä¸ªè§†é¢‘ï¼‰

**æ–¹æ¡ˆBï¼šèœå•æ¨¡æ¿å¤ç”¨**
- æˆ¿é—´è¿‡æœŸåï¼Œèœå•è‡ªåŠ¨ä¿å­˜ä¸ºã€Œæˆ‘çš„æ¨¡æ¿ã€
- ä¸‹æ¬¡åˆ›å»ºæˆ¿é—´å¯ç›´æ¥é€‰æ‹©å†å²æ¨¡æ¿
- è§£å†³èœå•é‡å¤åˆ›å»ºçš„ç—›ç‚¹

---

### é—®é¢˜2ï¼šã€Œæˆ¿é—´ã€æ¦‚å¿µå¢åŠ ç”¨æˆ·ç†è§£é—¨æ§›

**é—®é¢˜åˆ†ç±»**ï¼šæ¦‚å¿µè®¾è®¡é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
- æ ¸å¿ƒåŠŸèƒ½æ˜¯ã€Œåˆ›å»ºèœå•ã€å’Œã€ŒæŠ•ç¥¨é€‰èœã€
- ä½†ç•Œé¢ä½¿ç”¨ã€Œåˆ›å»ºæˆ¿é—´ã€ã€ŒåŠ å…¥æˆ¿é—´ã€çš„è¡¨è¿°
- ç”¨æˆ·ç¬¬ä¸€ååº”æ˜¯ã€Œæˆ¿é—´æ˜¯ä»€ä¹ˆï¼Ÿã€ã€Œæˆ‘è¦è¿›å“ªä¸ªæˆ¿é—´ï¼Ÿã€
- ã€Œæˆ¿é—´ã€æ˜¯æŠ€æœ¯å®ç°æ¦‚å¿µï¼Œä¸æ˜¯ç”¨æˆ·å¿ƒæ™ºæ¦‚å¿µ

**å½±å“åˆ†æ**ï¼š
- æ–°ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶å›°æƒ‘
- å¢åŠ äº§å“å­¦ä¹ æˆæœ¬
- ä¸ç«å“ï¼ˆå¦‚æ¥é¾™ã€æŠ•ç¥¨ï¼‰çš„ç”¨æˆ·è®¤çŸ¥ä¸ä¸€è‡´

**ä¿®æ”¹å»ºè®®**ï¼š
å°†ã€Œæˆ¿é—´ã€æ”¹ä¸ºæ›´ç›´è§‚çš„è¡¨è¿°ï¼š
- ã€Œåˆ›å»ºæˆ¿é—´ã€â†’ã€Œå‘èµ·ç‚¹é¤ã€æˆ–ã€Œåˆ›å»ºèœå•ã€
- ã€ŒåŠ å…¥æˆ¿é—´ã€â†’ã€Œå‚ä¸æŠ•ç¥¨ã€æˆ–ã€ŒåŠ å…¥ç‚¹é¤ã€
- ã€Œé‚€è¯·ç ã€â†’ã€Œç‚¹é¤ç ã€æˆ–ä¿ç•™
- ã€Œæˆ‘çš„æˆ¿é—´ã€â†’ã€Œæˆ‘çš„ç‚¹é¤ã€æˆ–ã€Œå‚ä¸è®°å½•ã€

---

## ä¸‰ã€P1 é‡è¦é—®é¢˜ï¼ˆä½“éªŒé˜»ç¢ï¼‰

### é—®é¢˜3ï¼šè¿‡æœŸæˆ¿é—´ä½“éªŒæ–­è£‚

**é—®é¢˜åˆ†ç±»**ï¼šæµç¨‹è®¾è®¡ç¼ºé™·

**é—®é¢˜æè¿°**ï¼š
- ç”¨æˆ·é€šè¿‡åˆ†äº«é“¾æ¥è¿›å…¥å·²è¿‡æœŸçš„æˆ¿é—´
- å½“å‰ä»…æ˜¾ç¤ºã€Œå·²ç»“æŸã€çŠ¶æ€ï¼Œæ— ä»»ä½•å¼•å¯¼
- ç”¨æˆ·ä¸çŸ¥é“ä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆ

**ä¿®æ”¹å»ºè®®**ï¼š
- è¿‡æœŸæˆ¿é—´æ˜¾ç¤ºä¸“å±å¼•å¯¼é¡µé¢
- æä¾›ã€ŒæŸ¥çœ‹æŠ•ç¥¨ç»“æœã€ã€Œè”ç³»åˆ›å»ºè€…ã€ã€Œåˆ›å»ºæ–°ç‚¹é¤ã€ç­‰é€‰é¡¹
- æ˜¾ç¤ºæˆ¿é—´è¿‡æœŸæ—¶é—´ï¼Œè®©ç”¨æˆ·çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ

---

### é—®é¢˜4ï¼šæŠ•ç¥¨åæ— æ³•æ’¤é”€ï¼Œåªèƒ½ä¿®æ”¹

**é—®é¢˜åˆ†ç±»**ï¼šåŠŸèƒ½ç¼ºå¤±

**é—®é¢˜æè¿°**ï¼š
- ç”¨æˆ·æŠ•ç¥¨åå¦‚æœæƒ³ã€Œå¼ƒæƒã€æˆ–ã€Œä¸å‚ä¸ã€ï¼Œæ— æ³•æ“ä½œ
- åªèƒ½é€šè¿‡å…¨éƒ¨å–æ¶ˆé€‰æ‹©åæäº¤ç©ºæŠ•ç¥¨ï¼ˆä½†æŒ‰é’®æ˜¯ç¦ç”¨çš„ï¼‰
- æ— ã€Œæ’¤é”€æŠ•ç¥¨ã€æˆ–ã€Œæ”¾å¼ƒæŠ•ç¥¨ã€é€‰é¡¹

**ä¿®æ”¹å»ºè®®**ï¼š
- æ·»åŠ ã€Œæ’¤é”€æŠ•ç¥¨ã€åŠŸèƒ½
- æˆ–å…è®¸æäº¤ç©ºé€‰æ‹©è¡¨ç¤ºå¼ƒæƒ
- åœ¨æŠ•ç¥¨è®°å½•ä¸­åŒºåˆ†ã€ŒæœªæŠ•ç¥¨ã€å’Œã€Œå¼ƒæƒã€

---

### é—®é¢˜5ï¼šåˆ›å»ºèœå•æ—¶æ— æ³•é¢„è§ˆæ•´ä½“æ•ˆæœ

**é—®é¢˜åˆ†ç±»**ï¼šä½“éªŒç¼ºå¤±

**é—®é¢˜æè¿°**ï¼š
- åˆ›å»ºèœå•æ—¶åªèƒ½é€ä¸ªç¼–è¾‘èœå“
- æ— æ³•é¢„è§ˆæˆå‘˜çœ‹åˆ°çš„æŠ•ç¥¨ç•Œé¢æ•ˆæœ
- åˆ›å»ºè€…ä¸ç¡®å®šèœå•å±•ç¤ºæ˜¯å¦ç¬¦åˆé¢„æœŸ

**ä¿®æ”¹å»ºè®®**ï¼š
- åˆ›å»ºé¡µé¢åº•éƒ¨æ·»åŠ ã€Œé¢„è§ˆã€æŒ‰é’®
- ç‚¹å‡»åæ˜¾ç¤ºæ¨¡æ‹ŸæŠ•ç¥¨ç•Œé¢
- é¢„è§ˆæ»¡æ„åå†æ­£å¼åˆ›å»º

---

### é—®é¢˜6ï¼šæŠ•ç¥¨ç»“æœç¼ºä¹æ•°æ®æ´å¯Ÿ

**é—®é¢˜åˆ†ç±»**ï¼šåŠŸèƒ½ä¸è¶³

**é—®é¢˜æè¿°**ï¼š
- ç»“æœé¡µä»…æ˜¾ç¤ºç¥¨æ•°æ’å
- æ— æ³•çœ‹åˆ°æŠ•ç¥¨å‚ä¸ç‡ã€æœªæŠ•ç¥¨äººå‘˜åå•
- åˆ›å»ºè€…æ— æ³•æœ‰æ•ˆå‚¬ä¿ƒæœªæŠ•ç¥¨æˆå‘˜

**ä¿®æ”¹å»ºè®®**ï¼š
- æ˜¾ç¤ºæŠ•ç¥¨å‚ä¸ç‡ï¼ˆå¦‚ï¼š8/10äººå·²æŠ•ç¥¨ï¼‰
- åˆ›å»ºè€…å¯æŸ¥çœ‹æœªæŠ•ç¥¨æˆå‘˜åˆ—è¡¨
- æ·»åŠ ã€Œä¸€é”®å‚¬ä¿ƒã€åŠŸèƒ½ï¼ˆå‘é€æ¨¡æ¿æ¶ˆæ¯ï¼‰

---

### é—®é¢˜7ï¼šèœå“å›¾ç‰‡åŠ è½½ä½“éªŒå·®

**é—®é¢˜åˆ†ç±»**ï¼šæ€§èƒ½é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
- èœå“å›¾ç‰‡è¾ƒå¤šæ—¶ï¼Œé¡µé¢åŠ è½½ç¼“æ…¢
- å›¾ç‰‡åŠ è½½è¿‡ç¨‹ä¸­æ— å ä½å›¾ï¼Œå¸ƒå±€è·³åŠ¨
- ç½‘ç»œå·®æ—¶å›¾ç‰‡åŠ è½½å¤±è´¥æ— é‡è¯•æœºåˆ¶

**ä¿®æ”¹å»ºè®®**ï¼š
- æ·»åŠ å›¾ç‰‡æ‡’åŠ è½½æœºåˆ¶
- ä½¿ç”¨éª¨æ¶å±æˆ–å ä½å›¾ä¼˜åŒ–åŠ è½½ä½“éªŒ
- å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡å’Œé‡è¯•æŒ‰é’®

---

## å››ã€P2 ä¸€èˆ¬é—®é¢˜ï¼ˆä½“éªŒä¼˜åŒ–ï¼‰

### é—®é¢˜8ï¼šæ— æ³•å¯¹èœå“è¿›è¡Œåˆ†ç±»/åˆ†ç»„
- æ‰€æœ‰èœå“å¹³é“ºå±•ç¤ºï¼Œæ— åˆ†ç±»
- å»ºè®®æ”¯æŒæ·»åŠ åˆ†ç±»æ ‡ç­¾ï¼ˆå‡‰èœ/çƒ­èœ/ä¸»é£Ÿ/é¥®å“ï¼‰

### é—®é¢˜9ï¼šåˆ†äº«å¡ç‰‡ä¿¡æ¯ä¸å¤Ÿä¸°å¯Œ
- åˆ†äº«å¡ç‰‡ä»…æ˜¾ç¤ºæˆ¿é—´åç§°
- å»ºè®®æ˜¾ç¤ºèœå“æ•°é‡ã€å‚ä¸äººæ•°ã€å‰©ä½™æ—¶é—´

### é—®é¢˜10ï¼šç¼ºå°‘æ–°æ‰‹å¼•å¯¼
- é¦–æ¬¡ä½¿ç”¨æ— ä»»ä½•å¼•å¯¼
- å»ºè®®æ·»åŠ åŠŸèƒ½å¼•å¯¼è’™å±‚

### é—®é¢˜11ï¼šæ— æ³•æŸ¥çœ‹å†å²æŠ•ç¥¨è®°å½•
- ç”¨æˆ·ä¸çŸ¥é“è‡ªå·±æŠ•äº†ä»€ä¹ˆ
- å»ºè®®ç»“æœé¡µé«˜äº®æ˜¾ç¤ºè‡ªå·±çš„æŠ•ç¥¨

### é—®é¢˜12ï¼šé‚€è¯·ç è¾“å…¥ä½“éªŒä¸ä½³
- ä¸æ”¯æŒç²˜è´´è‡ªåŠ¨è¯†åˆ«
- å»ºè®®è‡ªåŠ¨è½¬å¤§å†™ã€æ”¯æŒæ‰«ç åŠ å…¥

---

## äº”ã€P3 ä¼˜åŒ–å»ºè®®ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰

### é—®é¢˜13ï¼šç¼ºå°‘æ¶ˆæ¯é€šçŸ¥æœºåˆ¶
- å»ºè®®æ¥å…¥å¾®ä¿¡è®¢é˜…æ¶ˆæ¯
- æ”¯æŒæŠ•ç¥¨æé†’ã€ç»“æœé€šçŸ¥

### é—®é¢˜14ï¼šç¼ºå°‘æ•°æ®ç»Ÿè®¡åŠŸèƒ½
- å»ºè®®æ·»åŠ ä¸ªäººæ•°æ®çœ‹æ¿
- ç»Ÿè®¡æœ€å—æ¬¢è¿èœå“TOP10

### é—®é¢˜15ï¼šç•Œé¢ä¸ªæ€§åŒ–ä¸è¶³
- å»ºè®®æä¾›å¤šå¥—æˆ¿é—´ä¸»é¢˜
- èŠ‚æ—¥è‡ªåŠ¨åˆ‡æ¢åº”æ™¯çš®è‚¤

---

## å…­ã€æµ‹è¯•è½®æ¬¡è®°å½•

| è½®æ¬¡ | æµ‹è¯•é‡ç‚¹ | å‘ç°é—®é¢˜ | çŠ¶æ€ |
|------|---------|---------|------|
| 1 | é¦–é¡µåŠŸèƒ½ | æˆ¿é—´æ¦‚å¿µä¸ç›´è§‚ | å·²è®°å½• |
| 2 | åˆ›å»ºæµç¨‹ | æ— é¢„è§ˆåŠŸèƒ½ | å·²è®°å½• |
| 3 | æŠ•ç¥¨æµç¨‹ | æ— æ³•æ’¤é”€æŠ•ç¥¨ | å·²è®°å½• |
| 4 | ç»“æœæŸ¥çœ‹ | ç¼ºå°‘å‚ä¸ç‡ | å·²è®°å½• |
| 5 | åˆ†äº«æµç¨‹ | å¡ç‰‡ä¿¡æ¯å°‘ | å·²è®°å½• |
| 6 | è¿‡æœŸå¤„ç† | ä½“éªŒæ–­è£‚ | å·²è®°å½• |
| 7 | å›¾ç‰‡åŠ è½½ | åŠ è½½æ…¢ | å·²è®°å½• |
| 8 | æ–°ç”¨æˆ· | ç¼ºå°‘å¼•å¯¼ | å·²è®°å½• |
| 9 | é•¿æœŸä½¿ç”¨ | æ— å†å²è®°å½• | å·²è®°å½• |
| 10 | è¾¹ç•Œæµ‹è¯• | é‚€è¯·ç ä½“éªŒ | å·²è®°å½• |

---

## ä¸ƒã€ä¿®å¤ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆæœ¬å‘¨å®Œæˆï¼‰
- P0-1ï¼šæˆ¿é—´æœ‰æ•ˆæœŸæœºåˆ¶ä¼˜åŒ–
- P0-2ï¼šã€Œæˆ¿é—´ã€æ”¹ä¸ºã€Œç‚¹é¤ã€ç­‰ç›´è§‚è¡¨è¿°

### ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆä¸‹ç‰ˆæœ¬ï¼‰
- P1-3ï¼šè¿‡æœŸæˆ¿é—´å¼•å¯¼ä¼˜åŒ–
- P1-4ï¼šæ’¤é”€æŠ•ç¥¨åŠŸèƒ½
- P1-6ï¼šæŠ•ç¥¨å‚ä¸ç‡ç»Ÿè®¡

### ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼ˆåç»­è¿­ä»£ï¼‰
- P1-5ï¼šåˆ›å»ºé¢„è§ˆåŠŸèƒ½
- P1-7ï¼šå›¾ç‰‡åŠ è½½ä¼˜åŒ–
- P2ç³»åˆ—ï¼šåˆ†ç±»ã€åˆ†äº«å¡ç‰‡ã€æ–°æ‰‹å¼•å¯¼ç­‰

### é•¿æœŸè§„åˆ’
- P3ç³»åˆ—ï¼šæ¶ˆæ¯é€šçŸ¥ã€æ•°æ®ç»Ÿè®¡ã€ä¸ªæ€§åŒ–ä¸»é¢˜`,
      createdAt: 1703318400000,
      updatedAt: 1703318400000
    },
    {
      _id: 'doc_3',
      title: 'è¿è¥æ¨å¹¿æ‰‹å†Œ',
      type: 'marketing',
      content: `# è›‹å°å¨ è¿è¥æ¨å¹¿æ‰‹å†Œ

## ä¸€ã€äº§å“æ ¸å¿ƒå–ç‚¹

### 1.1 ä¸€å¥è¯ä»‹ç»
> **è›‹å°å¨ â€”â€” ä¸“æ³¨è§£å†³æ¯å¤©åƒå•¥çš„ä¸–çºªéš¾é¢˜**

### 1.2 æ ¸å¿ƒåŠŸèƒ½ä»·å€¼
| åŠŸèƒ½ | ç”¨æˆ·ä»·å€¼ |
|------|---------|
| ç¾¤ä½“æŠ•ç¥¨ç‚¹é¤ | å‘Šåˆ«é€‰æ‹©å›°éš¾ï¼Œæ°‘ä¸»å†³å®šåƒä»€ä¹ˆ |
| ä¸€é”®åˆ›å»ºæˆ¿é—´ | 3ç§’åˆ›å»ºï¼Œåˆ†äº«é‚€è¯·ç å³å¯å‚ä¸ |
| å®æ—¶æŠ•ç¥¨ç»“æœ | è°æƒ³åƒä»€ä¹ˆä¸€ç›®äº†ç„¶ |
| èœå“å›¾ç‰‡å±•ç¤º | çœ‹å›¾é€‰èœï¼Œæ›´æœ‰é£Ÿæ¬² |
| å¿«æ·èœå•æ¨¡æ¿ | å·èœã€ç²¤èœã€å®¶å¸¸èœä¸€é”®å¯¼å…¥ |

### 1.3 å·®å¼‚åŒ–ä¼˜åŠ¿
- æ— éœ€ä¸‹è½½APPï¼Œå¾®ä¿¡å°ç¨‹åºå³å¼€å³ç”¨
- æŠ•ç¥¨ç»“æœå®æ—¶åŒæ­¥ï¼Œæ”¯æŒä¿®æ”¹æŠ•ç¥¨
- 24å°æ—¶æˆ¿é—´è‡ªåŠ¨è¿‡æœŸï¼Œæ— éœ€æ‰‹åŠ¨æ¸…ç†
- ç•Œé¢ç®€æ´ï¼Œè€äººå°å­©éƒ½ä¼šç”¨

---

## äºŒã€ç›®æ ‡ç”¨æˆ·ç”»åƒ

### 2.1 æ ¸å¿ƒåœºæ™¯
| åœºæ™¯ | ç—›ç‚¹æè¿° |
|------|---------|
| å…¬å¸åŒäº‹èšé¤ | 10ä¸ªäºº10ä¸ªæ„è§ï¼Œå¾®ä¿¡ç¾¤é‡ŒåµåŠå¤©å®šä¸ä¸‹æ¥ |
| æœ‹å‹å‘¨æœ«çº¦é¥­ | æ¯æ¬¡éƒ½æ˜¯ã€Œéšä¾¿ã€ã€Œéƒ½è¡Œã€ï¼Œæœ€åè°éƒ½ä¸æ»¡æ„ |
| å®¶åº­æ—¥å¸¸ç‚¹é¤ | è€å©†é—®åƒå•¥ï¼Œå›ç­”ã€Œéšä¾¿ã€å°±æ˜¯æ‰¾æ­» |
| éƒ¨é—¨å›¢å»ºç‚¹é¤ | è¡Œæ”¿å°å§å§æŒ¨ä¸ªé—®ä¸€åœˆï¼Œç»Ÿè®¡åˆ°å´©æºƒ |

### 2.2 ç”¨æˆ·æ ‡ç­¾
- å¹´é¾„ï¼š22-40å²èŒåœºäººç¾¤
- ç‰¹å¾ï¼šç¤¾äº¤æ´»è·ƒï¼Œç»å¸¸ç»„ç»‡æˆ–å‚ä¸èšé¤
- ç—›ç‚¹ï¼šé€‰æ‹©å›°éš¾ç—‡ï¼Œå®³æ€•åšå†³å®š
- ä¹ æƒ¯ï¼šå¾®ä¿¡é‡åº¦ç”¨æˆ·ï¼Œä¹ æƒ¯å°ç¨‹åº

---

## ä¸‰ã€å¾®ä¿¡æœ‹å‹åœˆæ–‡æ¡ˆ

### 3.1 æ—¥å¸¸ç§è‰å‹

**ã€æ–‡æ¡ˆ1ã€‘ç—›ç‚¹å…±é¸£**
ã€Œä»Šå¤©åƒå•¥ï¼Ÿã€ã€Œéšä¾¿ã€ã€Œé‚£ç«é”…ï¼Ÿã€ã€Œä¸æƒ³åƒè¾£ã€ã€Œé‚£æ—¥æ–™ï¼Ÿã€ã€Œå¤ªè´µäº†ã€â€¦â€¦ è¿™æ ·çš„å¯¹è¯æ˜¯ä¸æ˜¯æ¯å¤©éƒ½åœ¨ä¸Šæ¼”ï¼ŸğŸ¤¦â€â™€ï¸ å®‰åˆ©ä¸€ä¸ªç¥å™¨ï¼šè›‹å°å¨ï¼Œåˆ›å»ºæŠ•ç¥¨æˆ¿é—´ï¼ŒæŠŠèœå•å‘ç¾¤é‡Œï¼Œè®©å¤§å®¶è‡ªå·±é€‰ï¼ä»æ­¤å‘Šåˆ«é€‰æ‹©å›°éš¾ç—‡ï½ å¾®ä¿¡æœã€Œè›‹å°å¨ã€è¯•è¯•

**ã€æ–‡æ¡ˆ2ã€‘åœºæ™¯ä»£å…¥**
å…¬å¸10ä¸ªäººèšé¤ï¼Œé—®äº†ä¸€åœˆæ¯ä¸ªäººéƒ½è¯´ã€Œéšä¾¿ã€ï¼Œæœ€åç‚¹çš„èœæ²¡ä¸€ä¸ªäººæ»¡æ„ ğŸ˜… åæ¥å‘ç°è¿™ä¸ªå°ç¨‹åºï¼Œåˆ›å»ºæˆ¿é—´â†’æ·»åŠ èœå“â†’åˆ†äº«åˆ°ç¾¤é‡Œâ†’å¤§å®¶æŠ•ç¥¨ï¼Œ2åˆ†é’Ÿæå®šï¼è°ä¹Ÿåˆ«æ€¨è°ï¼Œéƒ½æ˜¯è‡ªå·±é€‰çš„ ğŸ‘€

**ã€æ–‡æ¡ˆ3ã€‘è½»æ¾è°ƒä¾ƒ**
è‡ªä»ç”¨äº†è›‹å°å¨ï¼Œæˆ‘ä»¬éƒ¨é—¨çš„èšé¤æ•ˆç‡æå‡äº†300%ï¼Œåµæ¶ç‡ä¸‹é™äº†99%ï¼Œè¡Œæ”¿å°å§å§çš„å¤´å‘ä¹Ÿä¸æ‰äº† ğŸ’‡â€â™€ï¸ å»ºè®®æ‰€æœ‰è¢«ã€Œä»Šå¤©åƒå•¥ã€æŠ˜ç£¨è¿‡çš„äººéƒ½è¯•è¯•

### 3.2 åŠŸèƒ½å±•ç¤ºå‹

**ã€æ–‡æ¡ˆ4ã€‘æ­¥éª¤å¼•å¯¼**
å‘ç°ä¸€ä¸ªè¶…å¥½ç”¨çš„èšé¤ç¥å™¨ ğŸ‘‡
â‘  å¾®ä¿¡æœã€Œè›‹å°å¨ã€
â‘¡ åˆ›å»ºæˆ¿é—´ï¼Œæ·»åŠ æƒ³åƒçš„èœ
â‘¢ åˆ†äº«é‚€è¯·ç åˆ°ç¾¤é‡Œ
â‘£ å¤§å®¶æŠ•ç¥¨ï¼Œç¥¨é«˜çš„å°±ç‚¹ï¼
å†ä¹Ÿä¸ç”¨ä¸ºã€Œåƒä»€ä¹ˆã€çº ç»“äº†ï½

**ã€æ–‡æ¡ˆ5ã€‘å¯¹æ¯”åå·®**
ä»¥å‰ï¼šä»Šå¤©åƒå•¥â†’éšä¾¿â†’é‚£åƒXXXâ†’ä¸æƒ³åƒâ†’é‚£ä½ è¯´â†’éšä¾¿â†’... (å¾ªç¯2å°æ—¶)
ç°åœ¨ï¼šä»Šå¤©åƒå•¥â†’è¿›è›‹å°å¨æŠ•ç¥¨â†’3åˆ†é’Ÿå‡ºç»“æœâ†’å¼€åƒï¼
ç§‘æŠ€æ”¹å˜ç”Ÿæ´» âœ¨

---

## å››ã€å¾®ä¿¡ç¾¤åˆ†äº«æ–‡æ¡ˆ

### 4.1 å‘èµ·æŠ•ç¥¨æ—¶

**ã€æ¨¡æ¿1ã€‘æ­£å¼ç‰ˆ**
@æ‰€æœ‰äºº å‘¨äº”èšé¤æŠ•ç¥¨å¼€å§‹å•¦ï¼ğŸ‰
æˆ‘å·²ç»åœ¨ã€Œè›‹å°å¨ã€åˆ›å»ºäº†æŠ•ç¥¨æˆ¿é—´
ğŸ‘‰ é‚€è¯·ç ï¼šXXXXXX
è¯·å¤§å®¶è¿›å°ç¨‹åºæŠ•ç¥¨é€‰æ‹©æƒ³åƒçš„èœï½
æˆªæ­¢æ—¶é—´ï¼šæ˜å¤©ä¸­åˆ12ç‚¹
ç¥¨æ•°æœ€é«˜çš„èœå“æˆ‘ä»¬å°±ç‚¹ï¼

**ã€æ¨¡æ¿2ã€‘è½»æ¾ç‰ˆ**
å„ä½é¥¿è´§ä»¬ï¼ğŸœ
åˆ«å†è¯´ã€Œéšä¾¿ã€äº†ï¼Œè¿›æ¥æŠ•ç¥¨ï¼
å°ç¨‹åºæœã€Œè›‹å°å¨ã€â†’è¾“å…¥é‚€è¯·ç  XXXXXX
æƒ³åƒå•¥è‡ªå·±é€‰ï¼Œé€‰å®Œåˆ«åæ‚”å“¦ï½

**ã€æ¨¡æ¿3ã€‘å‚¬ä¿ƒç‰ˆ**
è¿˜æœ‰3ä¸ªäººæ²¡æŠ•ç¥¨å‘¢ï¼ğŸ‘€
@å¼ ä¸‰ @æå›› @ç‹äº”
å¿«è¿›è›‹å°å¨æŠ•ç¥¨ï¼Œé‚€è¯·ç  XXXXXX
å†ä¸æŠ•å°±æŒ‰å¼ƒæƒå¤„ç†ï¼Œåˆ«æ€ªæˆ‘ç‚¹ä½ ä»¬ä¸çˆ±åƒçš„ ğŸ˜

### 4.2 å…¬å¸ƒç»“æœæ—¶

**ã€æ¨¡æ¿4ã€‘ç»“æœå…¬å¸ƒ**
æŠ•ç¥¨ç»“æœå‡ºç‚‰ï¼ğŸ†
ğŸ¥‡ çº¢çƒ§è‚‰ - 8ç¥¨
ğŸ¥ˆ ç³–é†‹æ’éª¨ - 6ç¥¨
ğŸ¥‰ æ¸…è’¸é²ˆé±¼ - 5ç¥¨
æ°‘ä¸»çš„èƒœåˆ©ï¼ä»Šæ™šå°±åƒè¿™ä¸‰é“èœï½
æ„Ÿè°¢è›‹å°å¨è®©æˆ‘ä»¬ä¸å†çº ç»“ ğŸ˜‚

---

## äº”ã€å°çº¢ä¹¦ç§è‰æ–‡æ¡ˆ

### 5.1 ç§è‰ç¬”è®°æ¨¡æ¿

**ã€æ ‡é¢˜ã€‘**
æ•‘å‘½ï¼è¿™ä¸ªå°ç¨‹åºè§£å†³äº†æˆ‘å¤šå¹´çš„é€‰æ‹©å›°éš¾ç—‡ï¼ï¼

**ã€æ­£æ–‡ã€‘**
å§å¦¹ä»¬ï¼ï¼ä»Šå¤©å¿…é¡»å®‰åˆ©è¿™ä¸ªå®è—å°ç¨‹åº â€”â€”ã€Œè›‹å°å¨ã€ğŸ¥šğŸ‘¨â€ğŸ³

äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œä¸Šå‘¨å…¬å¸èšé¤ï¼Œ10ä¸ªäººåœ¨ç¾¤é‡Œè®¨è®ºäº†2å°æ—¶éƒ½æ²¡å®šä¸‹æ¥åƒå•¥ï¼ˆç¤¾æiäººç‹‚ç‚¹å¤´ï¼‰

åæ¥åŒäº‹åˆ†äº«äº†è¿™ä¸ªå°ç¨‹åºï¼Œç›´æ¥åˆ›å»ºæŠ•ç¥¨æˆ¿é—´ï¼ŒæŠŠæƒ³åƒçš„èœåŠ è¿›å»ï¼Œå¤§å®¶å„è‡ªæŠ•ç¥¨ï¼Œ3åˆ†é’Ÿå°±å‡ºç»“æœäº†ï¼ï¼

âœ¨ äº®ç‚¹åŠŸèƒ½ï¼š
â€¢ å¯ä»¥ä¸Šä¼ èœå“å›¾ç‰‡ï¼Œçœ‹å›¾é€‰æ›´æœ‰æ„Ÿè§‰
â€¢ å®æ—¶çœ‹åˆ°è°æŠ•äº†ä»€ä¹ˆ
â€¢ è¿˜èƒ½ä¿®æ”¹æŠ•ç¥¨
â€¢ 24å°æ—¶è‡ªåŠ¨å…³é—­ï¼Œä¸å å†…å­˜

ğŸ’¡ ä½¿ç”¨åœºæ™¯ï¼š
â€¢ åŒäº‹èšé¤
â€¢ æœ‹å‹çº¦é¥­
â€¢ å®¶åº­èšä¼š
â€¢ ç”šè‡³å¯ä»¥ç”¨æ¥æŠ•ç¥¨é€‰å¥¶èŒ¶å£å‘³ï¼

å¾®ä¿¡ç›´æ¥æœã€Œè›‹å°å¨ã€å°±èƒ½ç”¨ï¼Œä¸ç”¨ä¸‹è½½APPï½

é€‰æ‹©å›°éš¾ç—‡å§å¦¹å†²ï¼ï¼ï¼

**ã€æ ‡ç­¾ã€‘**
#é€‰æ‹©å›°éš¾ç—‡ #èšé¤ç¥å™¨ #å¾®ä¿¡å°ç¨‹åºæ¨è #æ‰“å·¥äººå¿…å¤‡ #è›‹å°å¨

---

## å…­ã€æŠ–éŸ³çŸ­è§†é¢‘è„šæœ¬

### 6.1 ç—›ç‚¹å…±é¸£å‹ï¼ˆ15ç§’ï¼‰

| æ—¶é—´ | ç”»é¢/å°è¯ |
|------|---------|
| 0-3ç§’ | ã€ç”»é¢ã€‘å¯¹è¯æ°”æ³¡åŠ¨ç”»ï¼šã€Œä»Šå¤©åƒå•¥ï¼Ÿã€ã€Œéšä¾¿ã€ã€Œé‚£åƒç«é”…ï¼Ÿã€ã€Œå¤ªè¾£ã€ã€Œé‚£çƒ§çƒ¤ï¼Ÿã€ã€Œä¸Šç«ã€ |
| 3-8ç§’ | ã€ç”»é¢ã€‘äººç‰©å´©æºƒè¡¨æƒ… ã€å°è¯ã€‘æ¯æ¬¡èšé¤æœ€éš¾çš„ä¸æ˜¯ä¹°å•ï¼Œæ˜¯å†³å®šåƒä»€ä¹ˆï¼ |
| 8-13ç§’ | ã€ç”»é¢ã€‘å±•ç¤ºå°ç¨‹åºç•Œé¢ ã€å°è¯ã€‘ç”¨è¿™ä¸ªå°ç¨‹åºï¼Œåˆ›å»ºæŠ•ç¥¨æˆ¿é—´ï¼Œè®©å¤§å®¶è‡ªå·±é€‰ï¼ |
| 13-15ç§’ | ã€ç”»é¢ã€‘æŠ•ç¥¨ç»“æœé¡µé¢ ã€å­—å¹•ã€‘å¾®ä¿¡æœã€Œè›‹å°å¨ã€å‘Šåˆ«é€‰æ‹©å›°éš¾ç—‡ |

### 6.2 æƒ…æ™¯å‰§å‹ï¼ˆ30ç§’ï¼‰

| æ—¶é—´ | ç”»é¢/å°è¯ |
|------|---------|
| 0-5ç§’ | ã€åœºæ™¯ã€‘åŠå…¬å®¤ï¼ŒåŒäº‹Aé—®ï¼šä»Šå¤©ä¸­åˆåƒå•¥ï¼Ÿä¼—äººé½å£°ï¼šéšä¾¿ï½ |
| 5-12ç§’ | ã€åœºæ™¯ã€‘åŒäº‹Aå´©æºƒï¼šæ¯æ¬¡éƒ½éšä¾¿ï¼Œç‚¹å®Œåˆè¯´ä¸å¥½åƒï¼åŒäº‹Bï¼šè¦ä¸æŠ•ç¥¨å†³å®šï¼Ÿ |
| 12-22ç§’ | ã€åœºæ™¯ã€‘å±•ç¤ºæ‰‹æœºæ“ä½œ ã€æ—ç™½ã€‘æ‰“å¼€è›‹å°å¨ï¼Œåˆ›å»ºæˆ¿é—´ï¼Œæ·»åŠ èœå“ï¼Œåˆ†äº«åˆ°ç¾¤é‡Œ |
| 22-28ç§’ | ã€åœºæ™¯ã€‘å¤§å®¶ä½å¤´æŠ•ç¥¨ï¼Œ3åˆ†é’Ÿåç»“æœå‡ºç‚‰ ä¼—äººï¼šå°±åƒçº¢çƒ§è‚‰ï¼ |
| 28-30ç§’ | ã€å­—å¹•ã€‘è›‹å°å¨ - ä¸“æ³¨è§£å†³æ¯å¤©åƒå•¥çš„ä¸–çºªéš¾é¢˜ |

---

## ä¸ƒã€èŠ‚æ—¥è¥é”€æ–‡æ¡ˆ

| èŠ‚æ—¥ | æ–‡æ¡ˆ |
|------|------|
| æ˜¥èŠ‚ | å¹´å¤œé¥­åƒä»€ä¹ˆï¼Ÿ7å¤§å§‘8å¤§å§¨éƒ½æœ‰ä¸åŒæ„è§ï¼Ÿç”¨è›‹å°å¨æŠ•ç¥¨ï¼Œè®©æ•°æ®è¯´è¯ï¼ğŸ§§ |
| æƒ…äººèŠ‚ | çº¦ä¼šåƒä»€ä¹ˆï¼Ÿåˆ«å†è®©ã€Œéšä¾¿ã€æ¯æ‰æµªæ¼«ï½ ç”¨è›‹å°å¨ï¼Œä¸¤ä¸ªäººä¹Ÿèƒ½æŠ•ç¥¨ ğŸ’• |
| ä¸­ç§‹èŠ‚ | å›¢åœ†é¥­èœå•éš¾å®šï¼Ÿå®¶åº­ç¾¤æŠ•ç¥¨èµ°èµ·ï¼è›‹å°å¨ç¥æ‚¨ä¸­ç§‹å¿«ä¹ ğŸ¥® |
| åœ£è¯èŠ‚ | Christmas Party åƒä»€ä¹ˆï¼Ÿåœ£è¯è€äººè¯´ï¼šæŠ•ç¥¨å†³å®šï¼ğŸ„ |
| å¹´ä¼šå­£ | å¹´ä¼šèšé¤æ€ä¹ˆç‚¹ï¼Ÿ50äººå¤§ç¾¤ä¹Ÿèƒ½è½»æ¾æŠ•ç¥¨ï¼ŒHRå¿…å¤‡ç¥å™¨ ğŸŠ |

---

## å…«ã€æ•°æ®æŒ‡æ ‡

### 8.1 æ ¸å¿ƒæŒ‡æ ‡
| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| DAU/MAU | æ—¥æ´»/æœˆæ´»ç”¨æˆ·æ•° |
| æ–°å¢ç”¨æˆ·æ•° | æ¯æ—¥/æ¯å‘¨æ–°æ³¨å†Œç”¨æˆ· |
| æˆ¿é—´åˆ›å»ºæ•° | æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨é¢‘æ¬¡ |
| äººå‡æŠ•ç¥¨æ¬¡æ•° | ç”¨æˆ·å‚ä¸æ·±åº¦ |
| åˆ†äº«ç‡ | ç”¨æˆ·è‡ªå‘ä¼ æ’­æ„æ„¿ |
| æ¬¡æ—¥ç•™å­˜ç‡ | ç”¨æˆ·ç²˜æ€§æŒ‡æ ‡ |`,
      createdAt: 1703318400000,
      updatedAt: 1703318400000
    },
    {
      _id: 'doc_4',
      title: 'æŠ€æœ¯å¼€å‘æ–‡æ¡£',
      type: 'design',
      content: `# è›‹å°å¨ æŠ€æœ¯å¼€å‘æ–‡æ¡£

## ä¸€ã€é¡¹ç›®ç»“æ„

\`\`\`
jcsq/
â”œâ”€â”€ cloudfunctions/          # äº‘å‡½æ•°
â”‚   â”œâ”€â”€ createRoom/          # åˆ›å»ºæˆ¿é—´
â”‚   â”œâ”€â”€ joinRoom/            # åŠ å…¥æˆ¿é—´
â”‚   â”œâ”€â”€ getRoomDetail/       # è·å–æˆ¿é—´è¯¦æƒ…
â”‚   â”œâ”€â”€ submitVote/          # æäº¤æŠ•ç¥¨
â”‚   â”œâ”€â”€ getVoteResults/      # è·å–æŠ•ç¥¨ç»“æœ
â”‚   â”œâ”€â”€ closeRoom/           # å…³é—­æˆ¿é—´
â”‚   â””â”€â”€ uploadImage/         # ä¸Šä¼ å›¾ç‰‡
â”œâ”€â”€ miniprogram/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index/           # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ create/          # åˆ›å»ºæˆ¿é—´
â”‚   â”‚   â””â”€â”€ room/            # æˆ¿é—´è¯¦æƒ…
â”‚   â”œâ”€â”€ images/              # å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ app.js               # åº”ç”¨å…¥å£
â”œâ”€â”€ project.config.json
â””â”€â”€ README.md
\`\`\`

---

## äºŒã€äº‘å‡½æ•°è¯´æ˜

### 2.1 createRoom - åˆ›å»ºæˆ¿é—´

**åŠŸèƒ½**ï¼šåˆ›å»ºæ–°çš„æŠ•ç¥¨æˆ¿é—´

**å‚æ•°**ï¼š
\`\`\`javascript
{
  roomName: string,    // æˆ¿é—´åç§°
  menu: Array          // èœå•åˆ—è¡¨
}
\`\`\`

**è¿”å›**ï¼š
\`\`\`javascript
{
  success: boolean,
  code: string,        // 6ä½é‚€è¯·ç 
  roomId: string       // æˆ¿é—´ID
}
\`\`\`

**é‚€è¯·ç ç”Ÿæˆè§„åˆ™**ï¼š
- 6ä½å­—æ¯+æ•°å­—ç»„åˆ
- æ’é™¤æ˜“æ··æ·†å­—ç¬¦ï¼ˆ0/O, 1/I/Lï¼‰
- æ£€æŸ¥é‡å¤åå…¥åº“

---

### 2.2 joinRoom - åŠ å…¥æˆ¿é—´

**åŠŸèƒ½**ï¼šé€šè¿‡é‚€è¯·ç åŠ å…¥æˆ¿é—´

**å‚æ•°**ï¼š
\`\`\`javascript
{
  code: string,        // é‚€è¯·ç 
  userInfo: {
    nickName: string,
    avatarUrl: string
  }
}
\`\`\`

**è¿”å›**ï¼š
\`\`\`javascript
{
  success: boolean,
  room: Object,        // æˆ¿é—´ä¿¡æ¯
  isCreator: boolean   // æ˜¯å¦åˆ›å»ºè€…
}
\`\`\`

---

### 2.3 submitVote - æäº¤æŠ•ç¥¨

**åŠŸèƒ½**ï¼šæäº¤æˆ–æ›´æ–°æŠ•ç¥¨

**å‚æ•°**ï¼š
\`\`\`javascript
{
  roomId: string,
  selectedDishes: Array  // é€‰ä¸­çš„èœå“IDæ•°ç»„
}
\`\`\`

**é€»è¾‘**ï¼š
1. æ£€æŸ¥æˆ¿é—´æ˜¯å¦æœ‰æ•ˆ
2. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²æŠ•ç¥¨
3. å·²æŠ•ç¥¨åˆ™æ›´æ–°ï¼ŒæœªæŠ•ç¥¨åˆ™æ–°å¢
4. è¿”å›æœ€æ–°æŠ•ç¥¨ç»“æœ

---

## ä¸‰ã€æ•°æ®åº“ç´¢å¼•

### rooms é›†åˆ
| å­—æ®µ | ç´¢å¼•ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| code | å”¯ä¸€ç´¢å¼• | é‚€è¯·ç æŸ¥è¯¢ |
| creatorOpenId | æ™®é€šç´¢å¼• | æˆ‘çš„æˆ¿é—´åˆ—è¡¨ |
| expireTime | æ™®é€šç´¢å¼• | è¿‡æœŸæ¸…ç† |

### votes é›†åˆ
| å­—æ®µ | ç´¢å¼•ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| roomId | æ™®é€šç´¢å¼• | æˆ¿é—´æŠ•ç¥¨æŸ¥è¯¢ |
| openId | æ™®é€šç´¢å¼• | ç”¨æˆ·æŠ•ç¥¨æŸ¥è¯¢ |
| roomId + openId | å¤åˆç´¢å¼• | å»é‡æ£€æŸ¥ |

---

## å››ã€å›¾ç‰‡å¤„ç†

### 4.1 ä¸Šä¼ æµç¨‹
1. ç”¨æˆ·é€‰æ‹©å›¾ç‰‡ï¼ˆwx.chooseMediaï¼‰
2. å‰ç«¯å‹ç¼©ï¼ˆcanvaså‹ç¼©è‡³1MBä»¥å†…ï¼‰
3. ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆ200x200ï¼‰
4. ä¸Šä¼ è‡³äº‘å­˜å‚¨
5. è¿”å› fileID

### 4.2 å‹ç¼©å‚æ•°
\`\`\`javascript
{
  maxWidth: 1080,      // å¤§å›¾æœ€å¤§å®½åº¦
  maxHeight: 1080,     // å¤§å›¾æœ€å¤§é«˜åº¦
  quality: 0.8,        // å‹ç¼©è´¨é‡
  thumbSize: 200       // ç¼©ç•¥å›¾å°ºå¯¸
}
\`\`\`

---

## äº”ã€å·²çŸ¥é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 5.1 å¾®ä¿¡å¤´åƒæ˜µç§°é—®é¢˜

**é—®é¢˜**ï¼š2021å¹´4æœˆèµ·ï¼Œwx.getUserProfile è¿”å›å›ºå®šå€¼

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨å¾®ä¿¡å®˜æ–¹ã€Œå¤´åƒæ˜µç§°å¡«å†™èƒ½åŠ›ã€
- button open-type="chooseAvatar"
- input type="nickname"
- ç”¨æˆ·ä¸»åŠ¨å¡«å†™åä¿å­˜è‡³æœ¬åœ°

### 5.2 å›¾ç‰‡åŠ è½½ä¼˜åŒ–

**é—®é¢˜**ï¼šå¤šå›¾åŠ è½½æ…¢ï¼Œå¸ƒå±€è·³åŠ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ç¼©ç•¥å›¾å±•ç¤ºåˆ—è¡¨
- ç‚¹å‡»æŸ¥çœ‹å¤§å›¾
- æ·»åŠ  loading å ä½å›¾
- å›¾ç‰‡æ‡’åŠ è½½

---

## å…­ã€éƒ¨ç½²æ¸…å•

### 6.1 äº‘å‡½æ•°éƒ¨ç½²
- [ ] createRoom
- [ ] joinRoom
- [ ] getRoomDetail
- [ ] submitVote
- [ ] getVoteResults
- [ ] closeRoom
- [ ] uploadImage

### 6.2 æ•°æ®åº“åˆå§‹åŒ–
- [ ] åˆ›å»º rooms é›†åˆ
- [ ] åˆ›å»º votes é›†åˆ
- [ ] é…ç½®ç´¢å¼•
- [ ] è®¾ç½®æƒé™

### 6.3 äº‘å­˜å‚¨é…ç½®
- [ ] åˆ›å»ºå›¾ç‰‡å­˜å‚¨ç›®å½•
- [ ] é…ç½®è®¿é—®æƒé™`,
      createdAt: 1703232000000,
      updatedAt: 1703318400000
    },
    {
      _id: 'doc_5',
      title: 'ç‰ˆæœ¬æ›´æ–°æ—¥å¿—',
      type: 'custom',
      content: `# è›‹å°å¨ ç‰ˆæœ¬æ›´æ–°æ—¥å¿—

## v1.0.3 (2024-12-24)

### ğŸ› Bug ä¿®å¤
- ä¿®å¤å¤´åƒæ˜µç§°æ˜¾ç¤ºä¸ºã€Œå¾®ä¿¡ç”¨æˆ·ã€çš„é—®é¢˜
- é€‚é…å¾®ä¿¡éšç§æ”¿ç­–ï¼Œæ”¹ç”¨å®˜æ–¹å¤´åƒæ˜µç§°å¡«å†™èƒ½åŠ›
- ä¿®å¤ç”¨æˆ·å–æ¶ˆé€‰æ‹©å¤´åƒæ—¶çš„æŠ¥é”™

### âœ¨ ä¼˜åŒ–
- æ–°ç”¨æˆ·ç™»å½•åè‡ªåŠ¨å¼¹å‡ºèµ„æ–™å¡«å†™å¼¹çª—
- è€ç”¨æˆ·å¦‚æœªè®¾ç½®æ˜µç§°ä¹Ÿä¼šæç¤ºå®Œå–„ä¿¡æ¯

---

## v1.0.2 (2024-12-23)

### ğŸ› Bug ä¿®å¤
- ä¿®å¤åˆ†äº«é“¾æ¥è¿›å…¥åè‡ªåŠ¨åŠ å…¥æˆ¿é—´çš„é—®é¢˜
- ç°åœ¨æ”¹ä¸ºæ˜¾ç¤ºç¡®è®¤å¼¹çª—ï¼Œç”¨æˆ·ä¸»åŠ¨é€‰æ‹©æ˜¯å¦åŠ å…¥

### âœ¨ ä¼˜åŒ–
- ä¼˜åŒ–å€’è®¡æ—¶æ˜¾ç¤ºé€»è¾‘ï¼Œå·²è¿‡æœŸæˆ¿é—´ä¸å†æ˜¾ç¤ºè´Ÿæ•°
- åˆ†äº«å¡ç‰‡æ ‡é¢˜æ˜¾ç¤ºæˆ¿é—´åç§°

---

## v1.0.1 (2024-12-22)

### ğŸ¨ å“ç‰Œå‡çº§
- äº§å“æ›´åï¼šèšé¤ç¥å™¨ â†’ è›‹å°å¨
- å…¨æ–° Logo è®¾è®¡
- æ›´æ–° Sloganï¼šä¸“æ³¨è§£å†³æ¯å¤©åƒå•¥çš„ä¸–çºªéš¾é¢˜

### âœ¨ ä¼˜åŒ–
- é¦–é¡µå¢åŠ æ°”æ³¡æç¤ºå¼•å¯¼
- ä¼˜åŒ–ç™»å½•æµç¨‹ï¼Œæ”¯æŒæ¸¸å®¢æµè§ˆ

---

## v1.0.0 (2024-12-20)

### ğŸ‰ é¦–æ¬¡å‘å¸ƒ

**æ ¸å¿ƒåŠŸèƒ½**
- åˆ›å»ºæŠ•ç¥¨æˆ¿é—´
- æ·»åŠ èœå“ï¼ˆåç§°ã€ä»·æ ¼ã€å¤‡æ³¨ã€å›¾ç‰‡ï¼‰
- 6ä½é‚€è¯·ç åˆ†äº«
- å¤šé€‰æŠ•ç¥¨
- å®æ—¶ç»“æœç»Ÿè®¡
- 24å°æ—¶è‡ªåŠ¨è¿‡æœŸ

**é¢„è®¾æ¨¡æ¿**
- å·èœ
- ç²¤èœ
- å®¶å¸¸èœ
- è¥¿é¤

---

## è§„åˆ’ä¸­åŠŸèƒ½

### v1.1 (é¢„è®¡1æœˆ)
- [ ] æˆ¿é—´æœ‰æ•ˆæœŸå»¶é•¿æœºåˆ¶
- [ ] èœå“åˆ†ç±»åŠŸèƒ½
- [ ] æŠ•ç¥¨æ’¤é”€åŠŸèƒ½
- [ ] æ–°æ‰‹å¼•å¯¼

### v2.0 (é¢„è®¡3æœˆ)
- [ ] è®¢é˜…æ¶ˆæ¯é€šçŸ¥
- [ ] å†å²è®°å½•ä¸ç»Ÿè®¡
- [ ] æˆ‘çš„æ¨¡æ¿
- [ ] ä¸ªäººå£å‘³åå¥½`,
      createdAt: 1703145600000,
      updatedAt: 1703318400000
    }
  ],
  issues: [
    { _id: 'issue_1', title: 'æˆ¿é—´24å°æ—¶è¿‡æœŸæœºåˆ¶ä¸åˆç†', priority: 'p0', status: 'open', createdAt: Date.now(), description: 'åˆ›å»ºè€…è¾›è‹¦ç¼–è¾‘çš„èœå•24å°æ—¶åå¤±æ•ˆï¼Œæ— æ³•å¤ç”¨ï¼›åˆ†äº«é“¾æ¥è¿‡æœŸåæ–°æˆå‘˜æ— æ³•åŠ å…¥' },
    { _id: 'issue_2', title: 'ã€Œæˆ¿é—´ã€æ¦‚å¿µå¢åŠ ç”¨æˆ·ç†è§£é—¨æ§›', priority: 'p0', status: 'open', createdAt: Date.now(), description: 'å»ºè®®æ”¹ä¸ºã€Œå‘èµ·ç‚¹é¤ã€ã€Œå‚ä¸æŠ•ç¥¨ã€ç­‰ç›´è§‚è¡¨è¿°' },
    { _id: 'issue_3', title: 'è¿‡æœŸæˆ¿é—´ä½“éªŒæ–­è£‚', priority: 'p1', status: 'open', createdAt: Date.now(), description: 'ç”¨æˆ·é€šè¿‡åˆ†äº«é“¾æ¥è¿›å…¥å·²è¿‡æœŸçš„æˆ¿é—´ï¼Œä»…æ˜¾ç¤ºå·²ç»“æŸçŠ¶æ€ï¼Œæ— ä»»ä½•å¼•å¯¼' },
    { _id: 'issue_4', title: 'æŠ•ç¥¨åæ— æ³•æ’¤é”€', priority: 'p1', status: 'open', createdAt: Date.now(), description: 'ç”¨æˆ·æŠ•ç¥¨åå¦‚æœæƒ³å¼ƒæƒæˆ–ä¸å‚ä¸ï¼Œæ— æ³•æ“ä½œ' },
    { _id: 'issue_5', title: 'åˆ›å»ºèœå•æ—¶æ— æ³•é¢„è§ˆ', priority: 'p1', status: 'open', createdAt: Date.now(), description: 'åˆ›å»ºè€…æ— æ³•é¢„è§ˆæˆå‘˜çœ‹åˆ°çš„æŠ•ç¥¨ç•Œé¢æ•ˆæœ' },
    { _id: 'issue_6', title: 'æŠ•ç¥¨ç»“æœç¼ºä¹æ•°æ®æ´å¯Ÿ', priority: 'p1', status: 'open', createdAt: Date.now(), description: 'æ— æ³•çœ‹åˆ°æŠ•ç¥¨å‚ä¸ç‡ã€æœªæŠ•ç¥¨äººå‘˜åå•' },
    { _id: 'issue_7', title: 'èœå“å›¾ç‰‡åŠ è½½ä½“éªŒå·®', priority: 'p1', status: 'open', createdAt: Date.now(), description: 'å›¾ç‰‡åŠ è½½æ…¢ï¼Œæ— å ä½å›¾ï¼Œå¸ƒå±€è·³åŠ¨' },
    { _id: 'issue_8', title: 'æ— æ³•å¯¹èœå“è¿›è¡Œåˆ†ç±»', priority: 'p2', status: 'open', createdAt: Date.now(), description: 'æ‰€æœ‰èœå“å¹³é“ºå±•ç¤ºï¼Œå»ºè®®æ”¯æŒåˆ†ç±»æ ‡ç­¾' },
    { _id: 'issue_9', title: 'åˆ†äº«å¡ç‰‡ä¿¡æ¯ä¸å¤Ÿä¸°å¯Œ', priority: 'p2', status: 'open', createdAt: Date.now(), description: 'ä»…æ˜¾ç¤ºæˆ¿é—´åç§°ï¼Œå»ºè®®å¢åŠ èœå“æ•°ã€å‚ä¸äººæ•°' },
    { _id: 'issue_10', title: 'ç¼ºå°‘æ–°æ‰‹å¼•å¯¼', priority: 'p2', status: 'open', createdAt: Date.now(), description: 'é¦–æ¬¡ä½¿ç”¨æ— ä»»ä½•å¼•å¯¼' },
    { _id: 'issue_11', title: 'æ— æ³•æŸ¥çœ‹å†å²æŠ•ç¥¨è®°å½•', priority: 'p2', status: 'open', createdAt: Date.now(), description: 'ç”¨æˆ·ä¸çŸ¥é“è‡ªå·±æŠ•äº†ä»€ä¹ˆ' },
    { _id: 'issue_12', title: 'é‚€è¯·ç è¾“å…¥ä½“éªŒä¸ä½³', priority: 'p2', status: 'open', createdAt: Date.now(), description: 'ä¸æ”¯æŒç²˜è´´è‡ªåŠ¨è¯†åˆ«ï¼Œå¤§å°å†™æ•æ„Ÿ' },
    { _id: 'issue_13', title: 'ç¼ºå°‘æ¶ˆæ¯é€šçŸ¥æœºåˆ¶', priority: 'p3', status: 'open', createdAt: Date.now(), description: 'å»ºè®®æ¥å…¥å¾®ä¿¡è®¢é˜…æ¶ˆæ¯' },
    { _id: 'issue_14', title: 'ç¼ºå°‘æ•°æ®ç»Ÿè®¡åŠŸèƒ½', priority: 'p3', status: 'open', createdAt: Date.now(), description: 'å»ºè®®æ·»åŠ ä¸ªäººæ•°æ®çœ‹æ¿' },
    { _id: 'issue_15', title: 'ç•Œé¢ä¸ªæ€§åŒ–ä¸è¶³', priority: 'p3', status: 'open', createdAt: Date.now(), description: 'å»ºè®®æä¾›å¤šå¥—æˆ¿é—´ä¸»é¢˜' }
  ],
  changelog: [
    { _id: 'log_1', date: '2024-12-25', content: 'éƒ¨ç½²é¡¹ç›®æ–‡æ¡£ä¸­å¿ƒåˆ° Vercel', createdAt: Date.now() },
    { _id: 'log_2', date: '2024-12-24', content: 'å®Œæˆv1.0æµ‹è¯•å¤ç›˜ï¼Œå‘ç°15ä¸ªé—®é¢˜', createdAt: Date.now() },
    { _id: 'log_3', date: '2024-12-24', content: 'ç”Ÿæˆè¿è¥æ¨å¹¿æ‰‹å†Œ', createdAt: Date.now() },
    { _id: 'log_4', date: '2024-12-24', content: 'ç”ŸæˆPRDäº§å“éœ€æ±‚æ–‡æ¡£v1.0', createdAt: Date.now() },
    { _id: 'log_5', date: '2024-12-23', content: 'ä¿®å¤å¤´åƒæ˜µç§°æ˜¾ç¤ºé—®é¢˜ï¼Œé€‚é…å¾®ä¿¡éšç§æ”¿ç­–', createdAt: Date.now() },
    { _id: 'log_6', date: '2024-12-23', content: 'ä¿®å¤åˆ†äº«é“¾æ¥è‡ªåŠ¨åŠ å…¥æˆ¿é—´çš„é—®é¢˜', createdAt: Date.now() },
    { _id: 'log_7', date: '2024-12-22', content: 'å®Œæˆå“ç‰Œå‡çº§ï¼Œæ›´åä¸ºã€Œè›‹å°å¨ã€', createdAt: Date.now() },
    { _id: 'log_8', date: '2024-12-21', content: 'ä¼˜åŒ–ç™»å½•æµç¨‹ï¼Œæ”¯æŒæ¸¸å®¢æµè§ˆ', createdAt: Date.now() },
    { _id: 'log_9', date: '2024-12-21', content: 'ä¼˜åŒ–å›¾ç‰‡ä¸Šä¼ ï¼Œæ”¯æŒå¤§å›¾+ç¼©ç•¥å›¾åŒç‰ˆæœ¬', createdAt: Date.now() },
    { _id: 'log_10', date: '2024-12-20', content: 'é¡¹ç›®å¯åŠ¨ï¼Œå®Œæˆv1.0æ ¸å¿ƒåŠŸèƒ½å¼€å‘', createdAt: Date.now() }
  ]
};

// ç”Ÿæˆå”¯ä¸€ID
const genId = (prefix) => \`\${prefix}_\${Date.now()}_\${Math.random().toString(36).substr(2, 9)}\`;

// ä¸­é—´ä»¶
app.use(express.json());
app.use(express.static(path.join(__dirname, 'public')));

// CORS
app.use((req, res, next) => {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
  res.header('Access-Control-Allow-Headers', 'Content-Type');
  if (req.method === 'OPTIONS') return res.sendStatus(200);
  next();
});

// ==================== æ–‡æ¡£ API ====================

app.get('/api/documents', (req, res) => {
  const docs = appData.documents.sort((a, b) => b.updatedAt - a.updatedAt);
  res.json({ success: true, data: docs });
});

app.get('/api/documents/:id', (req, res) => {
  const doc = appData.documents.find(d => d._id === req.params.id);
  if (!doc) return res.status(404).json({ success: false, error: 'æ–‡æ¡£ä¸å­˜åœ¨' });
  res.json({ success: true, data: doc });
});

app.post('/api/documents', (req, res) => {
  const { title, type, content } = req.body;
  const now = Date.now();
  const doc = {
    _id: genId('doc'),
    title,
    type: type || 'custom',
    content: content || '',
    createdAt: now,
    updatedAt: now
  };
  appData.documents.push(doc);
  res.json({ success: true, id: doc._id });
});

app.put('/api/documents/:id', (req, res) => {
  const doc = appData.documents.find(d => d._id === req.params.id);
  if (!doc) return res.status(404).json({ success: false, error: 'æ–‡æ¡£ä¸å­˜åœ¨' });
  
  const { title, type, content } = req.body;
  if (title) doc.title = title;
  if (type) doc.type = type;
  if (content !== undefined) doc.content = content;
  doc.updatedAt = Date.now();
  
  res.json({ success: true });
});

app.delete('/api/documents/:id', (req, res) => {
  const index = appData.documents.findIndex(d => d._id === req.params.id);
  if (index === -1) return res.status(404).json({ success: false, error: 'æ–‡æ¡£ä¸å­˜åœ¨' });
  appData.documents.splice(index, 1);
  res.json({ success: true });
});

// ==================== é—®é¢˜ API ====================

app.get('/api/issues', (req, res) => {
  const issues = appData.issues.sort((a, b) => {
    const priorityOrder = { p0: 0, p1: 1, p2: 2, p3: 3 };
    return priorityOrder[a.priority] - priorityOrder[b.priority];
  });
  res.json({ success: true, data: issues });
});

app.post('/api/issues', (req, res) => {
  const { title, priority, description } = req.body;
  const issue = {
    _id: genId('issue'),
    title,
    priority: priority || 'p2',
    description: description || '',
    status: 'open',
    createdAt: Date.now()
  };
  appData.issues.push(issue);
  res.json({ success: true, id: issue._id });
});

app.put('/api/issues/:id', (req, res) => {
  const issue = appData.issues.find(i => i._id === req.params.id);
  if (!issue) return res.status(404).json({ success: false, error: 'é—®é¢˜ä¸å­˜åœ¨' });
  
  const { status, title, priority, description } = req.body;
  if (status) issue.status = status;
  if (title) issue.title = title;
  if (priority) issue.priority = priority;
  if (description !== undefined) issue.description = description;
  issue.updatedAt = Date.now();
  
  res.json({ success: true });
});

app.delete('/api/issues/:id', (req, res) => {
  const index = appData.issues.findIndex(i => i._id === req.params.id);
  if (index === -1) return res.status(404).json({ success: false, error: 'é—®é¢˜ä¸å­˜åœ¨' });
  appData.issues.splice(index, 1);
  res.json({ success: true });
});

// ==================== æ›´æ–°æ—¥å¿— API ====================

app.get('/api/changelog', (req, res) => {
  const logs = appData.changelog.sort((a, b) => new Date(b.date) - new Date(a.date));
  res.json({ success: true, data: logs });
});

app.post('/api/changelog', (req, res) => {
  const { content, date } = req.body;
  const log = {
    _id: genId('log'),
    content,
    date: date || new Date().toISOString().split('T')[0],
    createdAt: Date.now()
  };
  appData.changelog.push(log);
  res.json({ success: true, id: log._id });
});

app.delete('/api/changelog/:id', (req, res) => {
  const index = appData.changelog.findIndex(l => l._id === req.params.id);
  if (index === -1) return res.status(404).json({ success: false, error: 'è®°å½•ä¸å­˜åœ¨' });
  appData.changelog.splice(index, 1);
  res.json({ success: true });
});

// ==================== ç»Ÿè®¡ API ====================

app.get('/api/stats', (req, res) => {
  const openIssues = appData.issues.filter(i => i.status !== 'done').length;
  const doneIssues = appData.issues.filter(i => i.status === 'done').length;
  const total = appData.issues.length;
  
  res.json({
    success: true,
    data: {
      totalDocs: appData.documents.length,
      totalIssues: total,
      openIssues,
      doneIssues,
      progress: total > 0 ? Math.round(doneIssues / total * 100) : 0
    }
  });
});

// åˆå§‹åŒ–
app.post('/api/init', (req, res) => {
  res.json({ success: true, message: 'æ•°æ®å·²å°±ç»ª' });
});

// å¥åº·æ£€æŸ¥
app.get('/health', (req, res) => {
  res.json({ status: 'ok', timestamp: new Date().toISOString() });
});

// é¦–é¡µ
app.get('/', (req, res) => {
  res.sendFile(path.join(__dirname, 'public', 'index.html'));
});

// å¯åŠ¨æœåŠ¡
if (require.main === module) {
  app.listen(PORT, () => {
    console.log(\`æœåŠ¡å·²å¯åŠ¨: http://localhost:\${PORT}\`);
  });
}

module.exports = app;
